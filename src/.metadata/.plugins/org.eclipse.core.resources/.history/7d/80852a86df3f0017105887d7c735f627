package model.DAO;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;

import util.Conexao;
import model.Contato;

public class ContatoDAO {
	
 public static Contato inserir(String nome, String email, String mensagem){
	 Contato contato= null;
	 try{
		 //criação do insert
		 String sql = "insert into contato(nome, email, mensagem) valeus(?, ?, ?)";
		 
		 //Obter a conexão com o banco de dados
		 Conexao conex = new Conexao("jdbc:myswl://localhost:3303/18_conexaobd",
				 "com.mysql.jdbc.Driver","root","cpd*234");
	
		 Connection con = conex.obterConexao();
		 
		 PreparedStatement comando = con.prepareStatement(sql);
		 
		 comando.setString(1, nome);
		 comando.setString(2, email);
		 comando.setString(3, mensagem);
	 
		 comando.executeUpdate();
		 
	 }catch(Exception e ){
		 System.out.println(e.getMessage());
	 }
	 contato = new Contato (nome, email, mensagem);
	 return contato;
 }
 public static Contato[] buscarTodos(){
	 Contato[] contatos = null;
	 
	 try{
		 //criação do insert
		 String sql = "insert into contato(nome, email, mensagem) valeus(?, ?, ?)";
		 
		 //Obter a conexão com o banco de dados
		 Conexao conex = new Conexao("jdbc:myswl://localhost:3303/18_conexaobd",
				 "com.mysql.jdbc.Driver","root","cpd*234");
	
		 Connection con = conex.obterConexao();
		 
		 Statement comando = con.createStatement();
			 
		 ResultSet rs = comando.executeQuery(sql);
		 
		 contatos = new Contato[10];
		  int i = 0;
		  while (rs.next()) {
			  contatos[i++] = new Contato(
				  rs.getInt("id"),
				  rs.getString("nome"),
				  rs.getString("email"),
				  rs.getString("mensagem"));
			  }
			  rs.close();
				 comando.close();
			  con.close();
		  }catch (Exception e){
			  System.out.println(e.getMessage());
		  }
		return contatos;  
	 }
 	public static Contato excluir(int id){
 		 Contato contato= null;
 		 try{
 			 //criação do insert
 			 String sql = "delete from contato where id = ?";
 			 //Obter a conexão com o banco de dados
 			 Conexao conex = new Conexao("jdbc:myswl://localhost:3303/18_conexaobd",
 					 "com.mysql.jdbc.Driver","root","cpd*234");
 		
 			 Connection con = conex.obterConexao();
 			 
 			 PreparedStatement comando = con.prepareStatement(sql);
 			 
 			 comando.setInt(1, id);
 			 comando.setUpdate();
 		 		 
 			 comando.executeUpdate();
 			 
 		 }catch(Exception e ){
 			 System.out.println(e.getMessage());
 		 }
 	 }
 }
